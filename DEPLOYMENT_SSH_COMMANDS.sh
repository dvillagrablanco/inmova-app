#!/bin/bash
# ğŸš€ COMANDOS PARA DEPLOYMENT VÃA SSH EN EL SERVIDOR
# Copia y pega estos comandos en tu terminal SSH

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  ğŸš€ DEPLOYMENT INMOVA APP - VÃA SSH"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# PASO 1: Conectar al servidor
echo "ğŸ“ PASO 1: Conectar al servidor"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Ejecuta en TU TERMINAL LOCAL:"
echo ""
echo "  ssh usuario@IP_SERVIDOR"
echo ""
echo "Ejemplo:"
echo "  ssh root@157.180.119.236"
echo "  O: ssh deploy@inmovaapp.com"
echo ""
read -p "Presiona ENTER cuando estÃ©s conectado al servidor..."

# PASO 2: Navegar al directorio de la app
echo ""
echo "ğŸ“ PASO 2: Navegar al directorio de la app"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Ejecuta en EL SERVIDOR:"
echo ""
echo "  cd /opt/inmova-app"
echo "  # O donde estÃ© tu app:"
echo "  # cd /home/deploy/inmova-app"
echo ""
read -p "Presiona ENTER cuando estÃ©s en el directorio..."

# PASO 3: Verificar estado actual
echo ""
echo "ğŸ“ PASO 3: Verificar estado actual"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "  git status"
echo "  git log --oneline -3"
echo ""

# PASO 4: Pull de cambios
echo ""
echo "ğŸ“ PASO 4: Pull de cambios desde GitHub"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "  git fetch origin"
echo "  git checkout main"
echo "  git merge origin/cursor/frontend-audit-inmovaapp-com-6336"
echo ""
echo "  # O si prefieres directamente:"
echo "  git pull origin cursor/frontend-audit-inmovaapp-com-6336"
echo ""

# PASO 5: Verificar quÃ© deployment usas
echo ""
echo "ğŸ“ PASO 5: Deployment segÃºn tu configuraciÃ³n"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Â¿QuÃ© sistema usas en el servidor?"
echo ""
echo "A) DOCKER (docker-compose)"
echo "   docker-compose down"
echo "   docker-compose up -d --build"
echo "   docker-compose logs -f app"
echo ""
echo "B) PM2 (Node.js directo)"
echo "   npm install"
echo "   npm run build"
echo "   pm2 reload inmova-app"
echo "   pm2 logs inmova-app"
echo ""
echo "C) SYSTEMD (Next.js como servicio)"
echo "   npm install"
echo "   npm run build"
echo "   systemctl restart inmova-app"
echo "   systemctl status inmova-app"
echo ""
echo "D) MANUAL (npm start)"
echo "   npm install"
echo "   npm run build"
echo "   # Matar proceso viejo:"
echo "   fuser -k 3000/tcp"
echo "   # Iniciar nuevo:"
echo "   npm start &"
echo ""

# PASO 6: Verificar
echo ""
echo "ğŸ“ PASO 6: Verificar deployment"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "  # Health check"
echo "  curl http://localhost:3000/api/health"
echo ""
echo "  # Ver logs"
echo "  # Docker: docker-compose logs -f app"
echo "  # PM2: pm2 logs inmova-app"
echo "  # Systemd: journalctl -u inmova-app -f"
echo ""
echo "  # Test desde fuera del servidor (desde TU MÃQUINA)"
echo "  curl https://inmovaapp.com/api/health"
echo ""

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  âœ… DEPLOYMENT COMPLETADO"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
