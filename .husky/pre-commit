#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged
npx lint-staged

# Run type check
echo "ğŸ” Running TypeScript type check..."
npx tsc --noEmit -p tsconfig.predeploy.json || {
  echo "âŒ Type check failed. Please fix TypeScript errors."
  exit 1
}

# Run tests for changed files
if [ -n "$TEST_BASE_URL" ]; then
  echo "ğŸ§ª Running critical tests..."
  npm run test:critical -- --silent || {
    echo "âŒ Tests failed. Please fix failing tests."
    exit 1
  }
else
  echo "âš ï¸ TEST_BASE_URL no configurado. Tests omitidos."
fi

echo "âœ… Pre-commit checks passed!"
