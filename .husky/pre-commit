#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged
npx lint-staged

# Run tests for changed JS/TS files
echo "ğŸ§ª Running related tests..."
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\\.(ts|tsx|js|jsx)$')
if [ -n "$STAGED_FILES" ]; then
  npx jest --ci --findRelatedTests $STAGED_FILES || {
    echo "âŒ Tests failed. Please fix failing tests."
    exit 1
  }
else
  echo "âœ… No JS/TS changes, skipping tests."
fi

echo "âœ… Pre-commit checks passed!"
